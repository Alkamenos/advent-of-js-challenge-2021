b604717043c08f68c7e153a09b3416d2
"use strict";

function _typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _react = _interopRequireWildcard(require("react"));

var _gear = _interopRequireDefault(require("../../../public/images/gear.svg"));

var _dayjs = _interopRequireDefault(require("dayjs"));

var _classnames = _interopRequireDefault(require("classnames"));

require("./index.css");

require("./App.css");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }

function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== "object" && typeof obj !== "function") { return { "default": obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj["default"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }

function _nonIterableRest() { throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== "undefined" && arr[Symbol.iterator] || arr["@@iterator"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"] != null) _i["return"](); } finally { if (_d) throw _e; } } return _arr; }

function _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }

function PomodoroTimer() {
  var audioEl = (0, _react.useRef)();

  var _useState = (0, _react.useState)(25 * 1000 * 60),
      _useState2 = _slicedToArray(_useState, 2),
      time = _useState2[0],
      setTime = _useState2[1];

  var _useState3 = (0, _react.useState)(time),
      _useState4 = _slicedToArray(_useState3, 2),
      currentTime = _useState4[0],
      setCurrentTime = _useState4[1];

  var _useState5 = (0, _react.useState)(false),
      _useState6 = _slicedToArray(_useState5, 2),
      isRunning = _useState6[0],
      setIsRunning = _useState6[1];

  var _useState7 = (0, _react.useState)(false),
      _useState8 = _slicedToArray(_useState7, 2),
      isRest = _useState8[0],
      setIsRest = _useState8[1];

  var _useState9 = (0, _react.useState)(false),
      _useState10 = _slicedToArray(_useState9, 2),
      isPopupOpen = _useState10[0],
      setPopupOpen = _useState10[1];

  var intervals = [{
    isRest: true,
    duration: 5 * 1000 * 60
  }, {
    isRest: true,
    duration: 15 * 1000 * 60
  }, {
    isRest: false,
    duration: 25 * 1000 * 60
  }];
  var timer;

  var toggleRunStop = function toggleRunStop() {
    setIsRunning(!isRunning);
  };

  var toggleSettingsOpen = function toggleSettingsOpen() {
    setPopupOpen(!isPopupOpen);
  };

  var updateTime = function updateTime(interval) {
    return function () {
      setCurrentTime(interval.duration);
      setIsRunning(false);
      setIsRest(interval.isRest);
      setTime(interval.duration);
      setPopupOpen(false);
    };
  };

  var startInterval = function startInterval() {
    if (!timer) {
      timer = setInterval(function () {
        setCurrentTime(function (time) {
          return time - 1000;
        });
      }, 1000);
    }
  };

  if (isRunning && currentTime <= 0) {
    clearInterval(timer);
    setIsRunning(false);
    setCurrentTime(time);
    audioEl.current.play();
  }

  (0, _react.useEffect)(function () {
    console.log(isRunning);

    if (isRunning) {
      startInterval();
    } else {
      clearInterval(timer);
    }

    return function () {
      clearInterval(timer);
    };
  }, [isRunning]);
  var r = 255;
  var progress = currentTime / time * 1595;
  return /*#__PURE__*/_react["default"].createElement("div", {
    className: "App"
  }, /*#__PURE__*/_react["default"].createElement("div", {
    className: "Pomodoro-timer"
  }, /*#__PURE__*/_react["default"].createElement("div", {
    className: (0, _classnames["default"])("Pomodoro-timer__progress", isRest ? "_green" : "_red")
  }, /*#__PURE__*/_react["default"].createElement("svg", {
    height: r * 2 + 10,
    viewBox: "0 0 ".concat(r * 2 + 10, " ").concat(r * 2 + 10),
    width: r * 2 + 10
  }, /*#__PURE__*/_react["default"].createElement("path", {
    d: "M".concat(r + 4, " 4 a ").concat(r, " ").concat(r, " 0 0 1 0 ").concat(r * 2, " a ").concat(r, " ").concat(r, " 0 0 1 0 -").concat(r * 2),
    strokeDasharray: "1595,1595",
    strokeDashoffset: progress
  }))), /*#__PURE__*/_react["default"].createElement("div", {
    className: "Pomodoro-timer__body"
  }, /*#__PURE__*/_react["default"].createElement("div", {
    className: "Pomodoro-timer__content"
  }, /*#__PURE__*/_react["default"].createElement("div", {
    className: "Pomodoro-timer__time"
  }, (0, _dayjs["default"])(currentTime).format("mm:ss")), /*#__PURE__*/_react["default"].createElement("div", {
    className: "Pomodoro-timer__controls"
  }, /*#__PURE__*/_react["default"].createElement("button", {
    className: "Settings-button",
    onClick: toggleRunStop
  }, isRunning ? "stop" : "start"), /*#__PURE__*/_react["default"].createElement("button", {
    className: "Settings-button",
    onClick: toggleSettingsOpen
  }, /*#__PURE__*/_react["default"].createElement("img", {
    alt: "Settings",
    src: _gear["default"]
  })), isPopupOpen && /*#__PURE__*/_react["default"].createElement("ul", {
    className: "Pomodoro-timer__popup"
  }, intervals.map(function (interval) {
    return /*#__PURE__*/_react["default"].createElement("li", {
      key: interval.duration,
      onClick: updateTime(interval)
    }, interval.isRest ? "Rest" : "Work", " ", (0, _dayjs["default"])(interval.duration).format("mm"), " min");
  })))))), /*#__PURE__*/_react["default"].createElement("audio", {
    src: "",
    ref: audioEl
  }));
}

PomodoroTimer.propTypes = {};
PomodoroTimer.defaultProps = {};
var _default = PomodoroTimer;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbIlBvbW9kb3JvVGltZXIiLCJhdWRpb0VsIiwidGltZSIsInNldFRpbWUiLCJjdXJyZW50VGltZSIsInNldEN1cnJlbnRUaW1lIiwiaXNSdW5uaW5nIiwic2V0SXNSdW5uaW5nIiwiaXNSZXN0Iiwic2V0SXNSZXN0IiwiaXNQb3B1cE9wZW4iLCJzZXRQb3B1cE9wZW4iLCJpbnRlcnZhbHMiLCJkdXJhdGlvbiIsInRpbWVyIiwidG9nZ2xlUnVuU3RvcCIsInRvZ2dsZVNldHRpbmdzT3BlbiIsInVwZGF0ZVRpbWUiLCJpbnRlcnZhbCIsInN0YXJ0SW50ZXJ2YWwiLCJzZXRJbnRlcnZhbCIsImNsZWFySW50ZXJ2YWwiLCJjdXJyZW50IiwicGxheSIsImNvbnNvbGUiLCJsb2ciLCJyIiwicHJvZ3Jlc3MiLCJmb3JtYXQiLCJzZXR0aW5nc0ljb24iLCJtYXAiLCJwcm9wVHlwZXMiLCJkZWZhdWx0UHJvcHMiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBOztBQUNBOztBQUVBOztBQUNBOztBQUNBOztBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUVBLFNBQVNBLGFBQVQsR0FBeUI7QUFDckIsTUFBTUMsT0FBTyxHQUFHLG9CQUFoQjs7QUFEcUIsa0JBRUcscUJBQVMsS0FBSyxJQUFMLEdBQVksRUFBckIsQ0FGSDtBQUFBO0FBQUEsTUFFZEMsSUFGYztBQUFBLE1BRVJDLE9BRlE7O0FBQUEsbUJBR2lCLHFCQUFTRCxJQUFULENBSGpCO0FBQUE7QUFBQSxNQUdkRSxXQUhjO0FBQUEsTUFHREMsY0FIQzs7QUFBQSxtQkFJYSxxQkFBUyxLQUFULENBSmI7QUFBQTtBQUFBLE1BSWRDLFNBSmM7QUFBQSxNQUlIQyxZQUpHOztBQUFBLG1CQUtPLHFCQUFTLEtBQVQsQ0FMUDtBQUFBO0FBQUEsTUFLZEMsTUFMYztBQUFBLE1BS05DLFNBTE07O0FBQUEsbUJBTWUscUJBQVMsS0FBVCxDQU5mO0FBQUE7QUFBQSxNQU1kQyxXQU5jO0FBQUEs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QXlCZSxNQUF6QixDQUFnQyxJQUFoQyxDQUZ6QyxTQURtQjtBQUFBLEdBQXRCLENBRFcsQ0FScEIsQ0FKSixDQURKLENBVEosQ0FESixlQWtDSTtBQUFPLElBQUEsR0FBRyxFQUFFLEVBQVo7QUFBZ0IsSUFBQSxHQUFHLEVBQUUzQjtBQUFyQixJQWxDSixDQURKO0FBc0NIOztBQUVERCxhQUFhLENBQUMrQixTQUFkLEdBQTBCLEVBQTFCO0FBR0EvQixhQUFhLENBQUNnQyxZQUFkLEdBQTZCLEVBQTdCO2VBR2VoQyxhIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCBzZXR0aW5nc0ljb24gZnJvbSAnLi4vLi4vLi4vcHVibGljL2ltYWdlcy9nZWFyLnN2ZydcbmltcG9ydCB7IHVzZUVmZmVjdCwgdXNlUmVmLCB1c2VTdGF0ZX0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgZGF5anMgZnJvbSBcImRheWpzXCI7XG5pbXBvcnQgY2xhc3NuYW1lcyBmcm9tIFwiY2xhc3NuYW1lc1wiO1xuaW1wb3J0IFwiLi9pbmRleC5jc3NcIlxuaW1wb3J0IFwiLi9BcHAuY3NzXCJcblxuZnVuY3Rpb24gUG9tb2Rvcm9UaW1lcigpIHtcbiAgICBjb25zdCBhdWRpb0VsID0gdXNlUmVmKCk7XG4gICAgY29uc3QgW3RpbWUsIHNldFRpbWVdID0gdXNlU3RhdGUoMjUgKiAxMDAwICogNjApXG4gICAgY29uc3QgW2N1cnJlbnRUaW1lLCBzZXRDdXJyZW50VGltZV0gPSB1c2VTdGF0ZSh0aW1lKTtcbiAgICBjb25zdCBbaXNSdW5uaW5nLCBzZXRJc1J1bm5pbmddID0gdXNlU3RhdGUoZmFsc2UpO1xuICAgIGNvbnN0IFtpc1Jlc3QsIHNldElzUmVzdF0gPSB1c2VTdGF0ZShmYWxzZSk7XG4gICAgY29uc3QgW2lzUG9wdXBPcGVuLCBzZXRQb3B1cE9wZW5dID0gdXNlU3RhdGUoZmFsc2UpO1xuICAgIGNvbnN0IGludGVydmFscyA9IFtcbiAgICAgICAge2lzUmVzdDogdHJ1ZSwgZHVyYXRpb246IDUgKiAxMDAwICogNjB9LFxuICAgICAgICB7aXNSZXN0OiB0cnVlLCBkdXJhdGlvbjogMTUgKiAxMDAwICogNjB9LFxuICAgICAgICB7aXNSZXN0OiBmYWxzZSwgZHVyYXRpb246IDI1ICogMTAwMCAqIDYwfVxuICAgIF07XG5cbiAgICBsZXQgdGltZXI7XG4gICAgY29uc3QgdG9nZ2xlUnVuU3RvcCA9ICgpID0+IHtcbiAgICAgICAgc2V0SXNSdW5uaW5nKCFpc1J1bm5pbmcpXG4gICAgfVxuXG4gICAgY29uc3QgdG9nZ2xlU2V0dGluZ3NPcGVuID0gKCkgPT4ge1xuICAgICAgICBzZXRQb3B1cE9wZW4oIWlzUG9wdXBPcGVuKVxuICAgIH1cblxuICAgIGNvbnN0IHVwZGF0ZVRpbWUgPSAoaW50ZXJ2YWwpID0+ICgpID0+IHtcbiAgICAgICAgc2V0Q3VycmVudFRpbWUoaW50ZXJ2YWwuZHVyYXRpb24pXG4gICAgICAgIHNldElzUnVubmluZyhmYWxzZSlcbiAgICAgICAgc2V0SXNSZXN0KGludGVydmFsLmlzUmVzdClcbiAgICAgICAgc2V0VGltZShpbnRlcnZhbC5kdXJhdGlvbilcbiAgICAgICAgc2V0UG9wdXBPcGVuKGZhbHNlKVxuICAgIH1cblxuICAgIGNvbnN0IHN0YXJ0SW50ZXJ2YWwgPSAoKSA9PiB7XG4gICAgICAgIGlmICghdGltZXIpIHtcbiAgICAgICAgICAgIHRpbWVyID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHNldEN1cnJlbnRUaW1lKCgodGltZSkgPT4gdGltZSAtIDEwMDApKVxuICAgICAgICAgICAgfSwgMTAwMClcbiAgICAgICAgfVxuICAgIH1cblxuXG4gICAgaWYgKGlzUnVubmluZyAmJiBjdXJyZW50VGltZSA8PSAwKSB7XG4gICAgICAgIGNsZWFySW50ZXJ2YWwodGltZXIpXG4gICAgICAgIHNldElzUnVubmluZyhmYWxzZSk7XG4gICAgICAgIHNldEN1cnJlbnRUaW1lKHRpbWUpO1xuICAgICAgICBhdWRpb0VsLmN1cnJlbnQucGxheSgpO1xuICAgIH1cblxuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGlzUnVubmluZylcbiAgICAgICAgaWYgKGlzUnVubmluZykge1xuICAgICAgICAgICAgc3RhcnRJbnRlcnZhbCgpO1xuICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICBjbGVhckludGVydmFsKHRpbWVyKVxuXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGltZXIpXG4gICAgICAgIH1cbiAgICB9LCBbaXNSdW5uaW5nXSlcblxuXG4gICAgY29uc3QgciA9IDI1NVxuICAgIGNvbnN0IHByb2dyZXNzID0gY3VycmVudFRpbWUgLyB0aW1lICogMTU5NVxuXG4gICAgcmV0dXJuIChcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJBcHBcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiUG9tb2Rvcm8tdGltZXJcIj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17Y2xhc3NuYW1lcyhcIlBvbW9kb3JvLXRpbWVyX19wcm9ncmVzc1wiLCBpc1Jlc3QgPyBcIl9ncmVlblwiIDogXCJfcmVkXCIpfT5cbiAgICAgICAgICAgICAgICAgICAgPHN2ZyBoZWlnaHQ9e3IgKiAyICsgMTB9IHZpZXdCb3g9e2AwIDAgJHtyICogMiArIDEwfSAke3IgKiAyICsgMTB9YH0gd2lkdGg9e3IgKiAyICsgMTB9PlxuICAgICAgICAgICAgICAgICAgICAgICAgPHBhdGggZD17YE0ke3IgKyA0fSA0IGEgJHtyfSAke3J9IDAgMCAxIDAgJHtyICogMn0gYSAke3J9ICR7cn0gMCAwIDEgMCAtJHtyICogMn1gfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Ryb2tlRGFzaGFycmF5PVwiMTU5NSwxNTk1XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cm9rZURhc2hvZmZzZXQ9e3Byb2dyZXNzfVxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgPC9zdmc+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJQb21vZG9yby10aW1lcl9fYm9keVwiPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIlBvbW9kb3JvLXRpbWVyX19jb250ZW50XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIlBvbW9kb3JvLXRpbWVyX190aW1lXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge2RheWpzKGN1cnJlbnRUaW1lKS5mb3JtYXQoXCJtbTpzc1wiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJQb21vZG9yby10aW1lcl9fY29udHJvbHNcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzTmFtZT1cIlNldHRpbmdzLWJ1dHRvblwiIG9uQ2xpY2s9e3RvZ2dsZVJ1blN0b3B9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7aXNSdW5uaW5nID8gXCJzdG9wXCIgOiBcInN0YXJ0XCJ9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzTmFtZT1cIlNldHRpbmdzLWJ1dHRvblwiIG9uQ2xpY2s9e3RvZ2dsZVNldHRpbmdzT3Blbn0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbWcgYWx0PVwiU2V0dGluZ3NcIiBzcmM9e3NldHRpbmdzSWNvbn0vPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtpc1BvcHVwT3BlbiAmJiA8dWwgY2xhc3NOYW1lPVwiUG9tb2Rvcm8tdGltZXJfX3BvcHVwXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtpbnRlcnZhbHMubWFwKGludGVydmFsID0+IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsaSBrZXk9e2ludGVydmFsLmR1cmF0aW9ufVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3VwZGF0ZVRpbWUoaW50ZXJ2YWwpfT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7aW50ZXJ2YWwuaXNSZXN0ID8gXCJSZXN0XCIgOiBcIldvcmtcIn0ge2RheWpzKGludGVydmFsLmR1cmF0aW9uKS5mb3JtYXQoXCJtbVwiKX0gbWluXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2xpPikpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdWw+fVxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8YXVkaW8gc3JjPXtcIlwifSByZWY9e2F1ZGlvRWx9Lz5cbiAgICAgICAgPC9kaXY+XG4gICAgKTtcbn1cblxuUG9tb2Rvcm9UaW1lci5wcm9wVHlwZXMgPSB7XG59O1xuXG5Qb21vZG9yb1RpbWVyLmRlZmF1bHRQcm9wcyA9IHtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IFBvbW9kb3JvVGltZXI7XG4iXX0=